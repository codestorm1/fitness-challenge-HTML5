define("views/LoginView",["jquery","backbone","fitness","customCodeClient"],function(e,t,n,r){var i=t.View.extend({initialize:function(){this.render()},events:{"click #login_submit":"loginSubmit"},render:function(){var t=e("#header_template"),n=e("#login_template");this.$el.empty(),this.$el.append(t.html()).append(n.html()),this.$el.trigger("create");var r=localStorage.getItem("lastEmail");return r&&e("#email").val(r),this},loginSubmit:function(){var t=e("#email").val();t&&localStorage.setItem("lastEmail",t);var i=e("#password").val();e.mobile.loading("show"),r.lookupFitnessUser(t,i,function(t,r){if(t){e.mobile.loading("hide"),n.user=r;var i=n.user.get("username");i&&(n.log("logged in as "+i+" ("+n.user.get("email")+")"),localStorage.setItem("username",i)),e.mobile.loading("show"),router.navigate("#home",!0)}else e.mobile.loading("hide"),n.showMessage("login failed\n "+r)})}});return i});